/**

/* Standard C includes -------------------------------------------------------*/
#include "main.h"
#include "string.h"

/* Private includes ----------------------------------------------------------*/

/* Self include --------------------------------------------------------------*/

/* Type definiton ------------------------------------------------------------*/
typedef enum
{
    GP_CONFIG = 0,
    GF_CONFIG
}cellConfig;

/* External variables definiton ----------------------------------------------*/

int32_t continuousChargingTableData[132] = {0};
int32_t continuousDischargingTableData[165] =  {0};
int32_t eFuseChargingTableData[132] = {0};
int32_t eFuseDischargingTableData[165] =  {0};   

int32_t socData[11] = { 0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100 };
int32_t chargingTemperatureData[12] =  { 0, 5, 10, 10, 15, 20, 25, 30, 40, 45, 50, 55 };
int32_t dischargingTemperatureData[15] =  { -20, -15, -10, 0, 5, 10, 15, 20, 25, 30, 40, 45, 50, 55, 60 };

int32_t chargingMaxElements[2] = { 12, 11 };    //[0] - temp, [1] - soc
int32_t dischargingMaxElements[2] = { 15, 11 }; //[0] - temp, [1] - soc

/*SOP tables for GP and GF cell chemistries*/
/*=========================================*/

//GP100 cells 2P config @ 90% DoD
const int32_t continuousChargingTableData_GP[132] = { 
    0,		0,		0,		0,		0,		0,		0,		0,		0,		0,		0,
    0,		0,		0,		0,		0,		0,		0,		0,		0,		0,		0,
    20,		20,		20,		20,		20,		20,		20,		20,		20,		20,		10,
    20,		40,		40,		40,		40,		40,		40,		40,		40,		40,		15,
    20,		40,		40,		40,		40,		40,		40,		40,		40,		40,		15,
    40,		80,		80,		80,		80,		80,		80,		80,		80,		80,		15,
    60,		120,	140,	140,	140,	140,	140,	140,	140,	140,	15,
    60,		120,	180,	180,	180,	180,	180,	180,	180,	180,	15,
    60,		120,	180,	180,	180,	180,	180,	180,	180,	180,	15,
    60,		100,	120,	120,	120,	120,	120,	120,	120,	120,	15,
    60,		60,		80,		80,		80,		80,		80,		80,		80,		80,		15,
    0,		0,		0,		0,		0,		0,		0,		0,		0,		0,		0 };

const int32_t continuousDischargingTableData_GP[165] =  { 
   18,		36,		90,		90,		90,		90,		90,		90,		90,		90,		90,
   36,		36,		90,		90,		90,		90,		90,		90,		90,		90,		90,
   36,		36,		90,		90,		90,		90,		90,		90,		90,		90,		90,
   36,		90,		90,		90,		90,		90,		90,		90,		90,		90,		90,
   36,		90,		108,	108,	108,	108,	108,	108,	108,	108,	108,
   36,		90,		108,	108,	108,	108,	108,	108,	108,	108,	108,
   54,		90,		144,	144,	144,	144,	144,	144,	144,	144,	144,
   81,		108,	144,	180,	180,	180,	180,	180,	180,	144,	144,
   90,		135,	180,	180,	180,	180,	180,	180,	180,	180,	180,
   90,		135,	180,	180,	180,	180,	180,	180,	180,	180,	180,
   90,		135,	180,	180,	180,	180,	180,	180,	180,	180,	180,
   90,		135,	180,	180,	180,	180,	180,	180,	180,	180,	180,
   36,		54,		108,	144,	144,	144,	144,	144,	144,	144,	144,
   18,		36,		54,		108,	108,	108,	108,	108,	108,	108,	108,
   18,		18,		18,		18,		18,		36,		36,		36,		36,		36,		36 };

const int32_t eFuseChargingTableData_GP[132] = {  
    0,		0,			0,			0,			0,			0,			0,			0,			0,			0,			0,
    0,		0,			0,			0,			0,			0,			0,			0,			0,			0,			0,
    0,		500,		500,		500,		500,		500,		500,		500,		500,		0,			0,
    0,		2000,		2000,		2000,		2000,		2000,		2000,		2000,		2000,		2000,		0,
    0,		8000,		8000,		8000,		8000,		8000,		8000,		8000,		8000,		2000,		0,
    0,		8000,		8000,		8000,		8000,		8000,		8000,		8000,		8000,		2000,		0,
    0,		8000,		18000,		50000,		50000,		50000,		50000,		50000,		50000,		2000,		0,
    0,		8000,		2000,		72000,		72000,		72000,		72000,		72000,		72000,		2000,		0,
    0,		8000,		2000,		72000,		72000,		72000,		72000,		72000,		72000,		2000,		0,
    0,		18000,		32000,		162000,		162000,		162000,		162000,		162000,		162000,		2000,		0,
    0,		8000,		32000,		72000,		72000,		72000,		72000,		72000,		72000,		2000,		0,
    0,		0,			0,			0,			0,			0,			0,			0,			0,			0,			0 };

const int32_t eFuseDischargingTableData_GP[165] =  {   
    0,		0,		0,		0,		0,		0,		0,		0,		0,		0,		0,
    0,		0,		0,		0,		0,		0,		0,		0,		0,		0,		0,
    0,		0,		0,		0,		0,		0,		0,		0,		0,		0,		0,
    0,		0,		0,		0,		0,		0,		0,		0,		0,		0,		0,
    0,		0,		0,		0,		0,		0,		0,		0,		0,		0,		0,
    0,		0,		2000,	2000,	2000,	32000,	32000,	32000,	32000,	32000,	32000,
    0,		0,		8000,	8000,	8000,	8000,	8000,	8000,	8000,	8000,	8000,
    0,		8000,	98000,	50000,	50000,	50000,	50000,	50000,	50000,	8000,	8000,
    0,		500,	50000,	200000,	200000,	200000,	200000,	200000,	200000,	50000,	50000,
    0,		500,	50000,	200000,	200000,	200000,	200000,	200000,	200000,	50000,	50000,
    0,		500,	50000,	200000,	200000,	200000,	200000,	200000,	200000,	50000,	50000,
    0,		500,	50000,	200000,	200000,	200000,	200000,	200000,	200000,	50000,	50000,
    0,		50000,	32000,	8000,	8000,	8000,	8000,	8000,	8000,	8000,	8000,
    0,		0,		0,		0,		0,		0,		0,		0,		0,		0,		0,
    0,		0,		0,		0,		0,		0,		0,		0,		0,		0,		0 };

//GF100 cells 2P config @ 90% DoD
const int32_t continuousChargingTableData_GF[132] = { 
    0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,
    0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,
    22,     22,     22,     22,     22,     22,     22,     22,     22,     22,     22,     18,
    54,     54,     54,     54,     54,     54,     54,     54,     54,     54,     54,     36,
    90,     90,     90,     90,     90,     90,     90,     90,     90,     90,     90,     36,
    180,    180,    180,    180,    180,    180,    180,    180,    180,    135,    135,    54,
    180,    180,    180,    180,    180,    180,    180,    180,    180,    144,    144,    144,
    180,    180,    180,    180,    180,    180,    180,    180,    180,    144,    144,    144,
    144,    144,    144,    144,    144,    144,    144,    144,    144,    144,    144,    54,
    0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0 };

// const int32_t continuousDischargingTableData_GF[165] =  { 
//     0,    10,    20,    60,     100,    100,    100,    100,    100,    100,    100,    100,
//     0,    20,    40,    100,    160,    160,    160,    160,    160,    160,    160,    160,
//     0,    20,    40,    100,    160,    160,    160,    160,    160,    160,    160,    160,
//     0,    20,    40,    100,    160,    160,    160,    160,    160,    160,    160,    160,
//     0,    20,    40,    100,    160,    160,    160,    160,    160,    160,    160,    160,
//     0,    40,    60,    120,    200,    200,    200,    200,    200,    200,    200,    200,
//     0,    40,    60,    120,    200,    200,    200,    200,    200,    200,    200,    200,
//     0,    40,    60,    120,    200,    200,    200,    200,    200,    200,    200,    200,
//     0,    40,    60,    120,    200,    200,    200,    200,    200,    200,    200,    200,
//     0,    40,    60,    120,    200,    200,    200,    200,    200,    200,    200,    200,
//     0,    40,    60,    120,    200,    200,    200,    200,    200,    200,    200,    200,
//     0,    40,    60,    120,    200,    200,    200,    200,    200,    200,    200,    200,
//     0,    20,    40,    100,    160,    160,    160,    160,    160,    160,    160,    160,
//     0,    6,     10,    30,     60,     60,     60,     60,     60,     60,     60,     60,
//     0,	  0,	 0,		0,		0,		0,		0,		0,		0,		0,		0,		0 };

const int32_t eFuseChargingTableData_GF[132] = {  
    0,		0,			0,			0,			0,			0,			0,			0,			0,			0,			0,
    0,		0,			0,			0,			0,			0,			0,			0,			0,			0,			0,
    0,		500,		500,		500,		500,		500,		500,		500,		500,		0,			0,
    0,		2000,		2000,		2000,		2000,		2000,		2000,		2000,		2000,		2000,		0,
    0,		8000,		8000,		8000,		8000,		8000,		8000,		8000,		8000,		2000,		0,
    0,		8000,		8000,		8000,		8000,		8000,		8000,		8000,		8000,		2000,		0,
    0,		8000,		18000,		50000,		50000,		50000,		50000,		50000,		50000,		2000,		0,
    0,		8000,		2000,		72000,		72000,		72000,		72000,		72000,		72000,		2000,		0,
    0,		8000,		2000,		72000,		72000,		72000,		72000,		72000,		72000,		2000,		0,
    0,		18000,		32000,		162000,		162000,		162000,		162000,		162000,		162000,		2000,		0,
    0,		8000,		32000,		72000,		72000,		72000,		72000,		72000,		72000,		2000,		0,
    0,		0,			0,			0,			0,			0,			0,			0,			0,			0,			0 };

const int32_t eFuseDischargingTableData_GF[165] =  {   
    0,		0,		0,		0,		0,		0,		0,		0,		0,		0,		0,
    0,		0,		0,		0,		0,		0,		0,		0,		0,		0,		0,
    0,		0,		0,		0,		0,		0,		0,		0,		0,		0,		0,
    0,		0,		0,		0,		0,		0,		0,		0,		0,		0,		0,
    0,		0,		0,		0,		0,		0,		0,		0,		0,		0,		0,
    0,		0,		2000,	2000,	2000,	32000,	32000,	32000,	32000,	32000,	32000,
    0,		0,		8000,	8000,	8000,	8000,	8000,	8000,	8000,	8000,	8000,
    0,		8000,	98000,	50000,	50000,	50000,	50000,	50000,	50000,	8000,	8000,
    0,		500,	50000,	200000,	200000,	200000,	200000,	200000,	200000,	50000,	50000,
    0,		500,	50000,	200000,	200000,	200000,	200000,	200000,	200000,	50000,	50000,
    0,		500,	50000,	200000,	200000,	200000,	200000,	200000,	200000,	50000,	50000,
    0,		500,	50000,	200000,	200000,	200000,	200000,	200000,	200000,	50000,	50000,
    0,		50000,	32000,	8000,	8000,	8000,	8000,	8000,	8000,	8000,	8000,
    0,		0,		0,		0,		0,		0,		0,		0,		0,		0,		0,
    0,		0,		0,		0,		0,		0,		0,		0,		0,		0,		0 };

/* Private constants ---------------------------------------------------------*/

/* Private variables ---------------------------------------------------------*/

/* Private function prototypes -----------------------------------------------*/

/* Private custom code -------------------------------------------------------*/

/* Function definition -------------------------------------------------------*/

void initializeSOPTable(uint8_t cellType)
{
    switch(cellType)
    {
        case GP_CONFIG: 
            memcpy(continuousChargingTableData, continuousChargingTableData_GP, sizeof(continuousChargingTableData_GP));
            memcpy(continuousDischargingTableData, continuousDischargingTableData_GP, sizeof(continuousDischargingTableData_GP));
            memcpy(eFuseChargingTableData, eFuseChargingTableData_GP, sizeof(eFuseChargingTableData_GP));
            memcpy(eFuseDischargingTableData, eFuseDischargingTableData_GP, sizeof(eFuseDischargingTableData_GP));

            break;

        // case GF_CONFIG:
        //     memcpy(continuousChargingTableData, continuousChargingTableData_GF, sizeof(continuousChargingTableData_GF));
        //     memcpy(continuousDischargingTableData, continuousDischargingTableData_GF, sizeof(continuousDischargingTableData_GF));
        //     memcpy(eFuseChargingTableData, eFuseChargingTableData_GF, sizeof(eFuseChargingTableData_GF));
        //     memcpy(eFuseDischargingTableData, eFuseDischargingTableData_GF, sizeof(eFuseDischargingTableData_GF));
        //     break;
    }
}


/* End of File ---------------------------------------------------------------*/




